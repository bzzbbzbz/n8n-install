# –°—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥ ‚Äî –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

## –û–±–∑–æ—Ä

**–°—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å–Ω—ã–π –ø–µ—Ä–∏–æ–¥, –≤–æ –≤—Ä–µ–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—Å–µ –≤—ã–∏–≥—Ä—ã—à–∏ –≤ —Å–ª–æ—Ç–∞—Ö —É–º–Ω–æ–∂–∞—é—Ç—Å—è. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç 2 —Ä–∞–∑–∞ –≤ —Å—É—Ç–∫–∏ –≤ —Å–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è. –ß–µ–º –∫–æ—Ä–æ—á–µ –ø–µ—Ä–∏–æ–¥ ‚Äî —Ç–µ–º –≤—ã—à–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å.

---

## –ú–µ—Ö–∞–Ω–∏–∫–∞

### –¢–∞–±–ª–∏—Ü–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å/–º–Ω–æ–∂–∏—Ç–µ–ª—å

| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ú–Ω–æ–∂–∏—Ç–µ–ª—å | –®–∞–Ω—Å –≤—ã–ø–∞–¥–µ–Ω–∏—è |
|--------------|-----------|----------------|
| 1 –º–∏–Ω        | √ó5        | 16.7% (1/6)    |
| 2 –º–∏–Ω        | √ó4        | 16.7% (1/6)    |
| 3 –º–∏–Ω        | √ó3        | 16.7% (1/6)    |
| 5 –º–∏–Ω        | √ó2.5      | 16.7% (1/6)    |
| 10 –º–∏–Ω       | √ó2        | 16.7% (1/6)    |
| 15 –º–∏–Ω       | √ó1.5      | 16.7% (1/6)    |

–ü—Ä–∏ –∫–∞–∂–¥–æ–º "–º–∏–≥–µ" —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å —Ä–∞–≤–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —Å—É—Ç–∫–∏:** 2
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –º–∏–≥–∞–º–∏:** —Å–ª—É—á–∞–π–Ω—ã–π, –Ω–æ –Ω–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–º–∏–Ω–∏–º—É–º 1 –º–∏–Ω—É—Ç–∞ —Ä–∞–∑–Ω–∏—Ü—ã)
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:**
  - 90% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 08:00‚Äì02:00 (–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è)
  - 10% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 02:00‚Äì08:00 (–Ω–æ—á—å)
- **–¢–∞–π–º–∑–æ–Ω–∞:** `Asia/Yekaterinburg` (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ `reports.timezone`)

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–í 00:00 –ø–æ —Ç–∞–π–º–∑–æ–Ω–µ –±–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 2 —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–µ–∫—É—â–∏–µ —Å—É—Ç–∫–∏:

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 2 –º–∏–≥–æ–≤:
1. –í—ã–±—Ä–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ª–æ—Ç:
   - –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 90%: —Å–ª—É—á–∞–π–Ω–∞—è –º–∏–Ω—É—Ç–∞ –≤ 08:00‚Äì02:00 (18 —á–∞—Å–æ–≤ = 1080 –º–∏–Ω—É—Ç)
   - –° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 10%: —Å–ª—É—á–∞–π–Ω–∞—è –º–∏–Ω—É—Ç–∞ –≤ 02:00‚Äì08:00 (6 —á–∞—Å–æ–≤ = 360 –º–∏–Ω—É—Ç)
2. –í—ã–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã (—Ä–∞–≤–Ω—ã–µ —à–∞–Ω—Å—ã)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–∞–º—è—Ç—å/Redis
```

–ï—Å–ª–∏ –¥–≤–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–≤–ø–∞–ª–∏ ‚Äî –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Ç–æ—Ä–æ–µ.

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∏–≥—Ä–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π

### –û–±–ª–∞—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏—è

- ‚úÖ –°–ª–æ—Ç—ã (üé∞) ‚Äî –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- ‚ùå –î—É—ç–ª–∏ (üé≤) ‚Äî –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è
- ‚ùå –ü–µ—Ä–µ–≤–æ–¥—ã, –∫—Ä–µ–¥–∏—Ç—ã ‚Äî –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è

### –°—Ç–µ–∫–∞–Ω–∏–µ —Å –¥–∂–µ–∫–ø–æ—Ç–æ–º

–ú–Ω–æ–∂–∏—Ç–µ–ª—å "—Å—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –º–∏–≥–∞" **–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö** –¥–∂–µ–∫–ø–æ—Ç-–º–Ω–æ–∂–∏—Ç–µ–ª—è:

```
–ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–∏–≥—Ä—ã—à = –±–∞–∑–æ–≤—ã–µ_–æ—á–∫–∏ √ó bid √ó jackpot_multiplier √ó happy_moment_multiplier
```

**–ü—Ä–∏–º–µ—Ä:**
- –ò–≥—Ä–æ–∫ –≤—ã–±–∏–ª 777 (+10 –æ—á–∫–æ–≤) —Å bid=2
- –í—ã–ø–∞–ª Grand Jackpot (√ó10)
- –ê–∫—Ç–∏–≤–µ–Ω "—Å—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥" (√ó3)
- –ò—Ç–æ–≥–æ: 10 √ó 2 √ó 10 √ó 3 = **600 –æ—á–∫–æ–≤**

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∏–≥—Ä—ã—à

| –ö–æ–º–±–∏–Ω–∞—Ü–∏—è | bid | Jackpot | –ú–∏–≥  | –ò—Ç–æ–≥–æ |
|------------|-----|---------|------|-------|
| 777 (+10)  | 10  | √ó10     | √ó5   | 5000  |
| BAR√ó3 (+5) | 10  | √ó10     | √ó5   | 2500  |
| –¢—Ä–∏ –æ–¥–∏–Ω–∞–∫ (+7) | 10 | √ó10  | √ó5   | 3500  |

*–ü—Ä–∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–º bid=1-3 –∏ –±–µ–∑ Grand Jackpot –≤—ã–∏–≥—Ä—ã—à–∏ –±—É–¥—É—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä–æ–º–Ω–µ–µ.*

---

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å—Ç–∞—Ä—Ç–µ

```
üé∞‚ú® {–ù–ê–ó–í–ê–ù–ò–ï}! ‚ú®üé∞

–ë–ª–∏–∂–∞–π—à–∏–µ {N} –º–∏–Ω—É—Ç –≤—Å–µ –≤—ã–∏–≥—Ä—ã—à–∏ –≤ —Å–ª–æ—Ç–∞—Ö —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ {X}!

–ö—Ä—É—Ç–∏—Ç–µ –±–∞—Ä–∞–±–∞–Ω—ã! üçÄ
```

### –ü—É–ª –Ω–∞–∑–≤–∞–Ω–∏–π

–ü—Ä–∏ –∫–∞–∂–¥–æ–º "–º–∏–≥–µ" —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–¥–Ω–æ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π:

- –°—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥
- –ó–æ–ª–æ—Ç–æ–π —á–∞—Å
- –ë–æ–Ω—É—Å-—Ç–∞–π–º
- –î–∂–µ–∫–ø–æ—Ç-—Ä–∞—à
- –ó–≤—ë–∑–¥–Ω—ã–π —á–∞—Å
- –§–æ—Ä—Ç—É–Ω–∞ —É–ª—ã–±–∞–µ—Ç—Å—è
- –í—Ä–µ–º—è —É–¥–∞—á–∏
- –©–µ–¥—Ä—ã–π –º–æ–º–µ–Ω—Ç

### –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

```
üé∞‚ú® –î–∂–µ–∫–ø–æ—Ç-—Ä–∞—à! ‚ú®üé∞

–ë–ª–∏–∂–∞–π—à–∏–µ 3 –º–∏–Ω—É—Ç—ã –≤—Å–µ –≤—ã–∏–≥—Ä—ã—à–∏ –≤ —Å–ª–æ—Ç–∞—Ö —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ 3!

–ö—Ä—É—Ç–∏—Ç–µ –±–∞—Ä–∞–±–∞–Ω—ã! üçÄ
```

```
üé∞‚ú® –§–æ—Ä—Ç—É–Ω–∞ —É–ª—ã–±–∞–µ—Ç—Å—è! ‚ú®üé∞

–ë–ª–∏–∂–∞–π—à–∏–µ 1 –º–∏–Ω—É—Ç—É –≤—Å–µ –≤—ã–∏–≥—Ä—ã—à–∏ –≤ —Å–ª–æ—Ç–∞—Ö —É–º–Ω–æ–∂–∞—é—Ç—Å—è –Ω–∞ 5!

–ö—Ä—É—Ç–∏—Ç–µ –±–∞—Ä–∞–±–∞–Ω—ã! üçÄ
```

### –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤–æ –≤—Å–µ —á–∞—Ç—ã –∏–∑ `allowed_chat_ids` –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### Event History

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∏–≥—Ä—ã—à–µ –≤–æ –≤—Ä–µ–º—è "—Å—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –º–∏–≥–∞" —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å:

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| `event_type` | `happy_moment_win` |
| `amount` | –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–∏–≥—Ä—ã—à (—Å —É—á—ë—Ç–æ–º –º–Ω–æ–∂–∏—Ç–µ–ª—è) |
| `metadata` | JSON —Å –¥–µ—Ç–∞–ª—è–º–∏ |

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ metadata:**

```json
{
  "base_win": 10,
  "bid": 2,
  "jackpot_multiplier": 1,
  "happy_moment_multiplier": 3,
  "happy_moment_name": "–î–∂–µ–∫–ø–æ—Ç-—Ä–∞—à",
  "duration_minutes": 3
}
```

### –°–æ–±—ã—Ç–∏–µ —Å—Ç–∞—Ä—Ç–∞ –º–∏–≥–∞

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| `event_type` | `happy_moment_start` |
| `user_id` | `0` (—Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ) |
| `amount` | –ú–Ω–æ–∂–∏—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3) |
| `metadata` | JSON —Å –¥–µ—Ç–∞–ª—è–º–∏ |

```json
{
  "name": "–î–∂–µ–∫–ø–æ—Ç-—Ä–∞—à",
  "duration_minutes": 3,
  "multiplier": 3
}
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### settings.toml

```toml
[happy_moment]
enabled = true
events_per_day = 2
active_hours_weight = 90        # % –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –∞–∫—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è
active_hours_start = "08:00"    # –ù–∞—á–∞–ª–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
active_hours_end = "02:00"      # –ö–æ–Ω–µ—Ü –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (—Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å)

# –¢–∞–±–ª–∏—Ü–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å ‚Üí –º–Ω–æ–∂–∏—Ç–µ–ª—å
[[happy_moment.tiers]]
duration_minutes = 1
multiplier = 5.0

[[happy_moment.tiers]]
duration_minutes = 2
multiplier = 4.0

[[happy_moment.tiers]]
duration_minutes = 3
multiplier = 3.0

[[happy_moment.tiers]]
duration_minutes = 5
multiplier = 2.5

[[happy_moment.tiers]]
duration_minutes = 10
multiplier = 2.0

[[happy_moment.tiers]]
duration_minutes = 15
multiplier = 1.5
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–í Redis (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**

```
happy_moment:schedule ‚Äî JSON —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∏–≥–æ–≤ –Ω–∞ —Å—É—Ç–∫–∏
happy_moment:active ‚Äî —Ç–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –º–∏–≥ (–∏–ª–∏ null)
```

**–í –ø–∞–º—è—Ç–∏ (fallback):**

–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (APScheduler)

| –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|-------|----------|
| `generate_happy_moments_schedule` | 00:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 2 —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—Ä–µ–º—ë–Ω |
| `start_happy_moment` | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ | –ó–∞–ø—É—Å–∫ –º–∏–≥–∞, –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π |
| `end_happy_moment` | –ß–µ—Ä–µ–∑ N –º–∏–Ω—É—Ç | –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∏–≥–∞ |

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ spin handler

```python
# –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å–ª–æ—Ç–æ–≤ (group_games.py –∏–ª–∏ spin.py)
async def process_spin_result(...):
    base_win = calculate_base_win(dice_value)
    
    if base_win > 0:
        # –ü—Ä–∏–º–µ–Ω–∏—Ç—å bid
        win = base_win * user_bid
        
        # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –¥–∂–µ–∫–ø–æ—Ç
        jackpot_mult = roll_jackpot()
        win *= jackpot_mult
        
        # –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥
        happy_moment = get_active_happy_moment()
        if happy_moment:
            win *= happy_moment.multiplier
            # –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ happy_moment_win
        
        await db.update_balance(user_id, win)
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
bot/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ happy_moment.py    # HappyMomentService
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ group_games.py     # –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è spin handler
```

**HappyMomentService:**

```python
class HappyMomentService:
    def __init__(self, config, scheduler, bot):
        self.config = config
        self.scheduler = scheduler
        self.bot = bot
        self.active_moment: Optional[HappyMoment] = None
        self.schedule: List[ScheduledMoment] = []
    
    async def generate_daily_schedule(self):
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å—É—Ç–∫–∏ (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ 00:00)"""
        ...
    
    async def start_moment(self, moment: ScheduledMoment):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç —Å—á–∞—Å—Ç–ª–∏–≤—ã–π –º–∏–≥"""
        ...
    
    async def end_moment(self):
        """–ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –º–∏–≥"""
        ...
    
    def get_active_multiplier(self) -> Optional[float]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –∏–ª–∏ None"""
        ...
    
    def is_active(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –º–∏–≥"""
        ...
```

---

## –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

| –°–∏—Ç—É–∞—Ü–∏—è | –ü–æ–≤–µ–¥–µ–Ω–∏–µ |
|----------|-----------|
| –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –≤–æ –≤—Ä–µ–º—è –º–∏–≥–∞ | –ú–∏–≥ —Ç–µ—Ä—è–µ—Ç—Å—è (–Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è) |
| –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è | –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ |
| –î–≤–∞ –º–∏–≥–∞ –≤—ã–ø–∞–ª–∏ –Ω–∞ –æ–¥–Ω–æ –≤—Ä–µ–º—è | –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Ç–æ—Ä–æ–π |
| –ú–∏–≥ –≤—ã–ø–∞–ª –Ω–∞ 23:59, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å 15 –º–∏–Ω | –ú–∏–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–ª—É–Ω–æ—á–∏ |
| –ò–≥—Ä–æ–∫ –∫—Ä—É—Ç–∏—Ç —Å–ª–æ—Ç—ã —Ä–æ–≤–Ω–æ –≤ –º–æ–º–µ–Ω—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ timestamp –Ω–∞—á–∞–ª–∞ —Å–ø–∏–Ω–∞ |

---

## –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

–ù–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è `event_history` —Å –Ω–æ–≤—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Å–æ–±—ã—Ç–∏–π:

- `happy_moment_start`
- `happy_moment_win`

---

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ –≤ —Å–∫–æ—É–ø–µ)

- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –º–∏–≥–∞
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ "–º–∏–≥–æ–≤" –≤ `/stats`
- [ ] –ö–æ–º–∞–Ω–¥–∞ `/nextbonus` ‚Äî –≤—Ä–µ–º—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–∏–≥–∞ (—Å–ø–æ–π–ª–µ—Ä?)
- [ ] –†–∞–∑–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø
- [ ] –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –º–∏–≥–∞ –∞–¥–º–∏–Ω–æ–º
